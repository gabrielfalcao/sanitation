# sanitation

data types for forensic analysis of protocol implementations et
cetera.

## Basic Design

Structs provide a `garbage()` method which returns potentially
malicious bytes, particularly useful for detecting attempts to
buffer-overflow in protocol implementations

```shell
cargo add sanitation
```

## Mini Demo

```rust
// Based on https://www.exploit-db.com/exploits/51641
use sanitation::SString;
let general_device_manager = vec![
    0xb8, 0x9c, 0x78, 0x14, 0x60, 0xd9, 0xc2, 0xd9,
    0x74, 0x24, 0xf4, 0x5a, 0x33, 0xc9, 0xb1, 0x31,
    0x83, 0xea, 0xfc, 0x31, 0x42, 0x0f, 0x03, 0x42,
    0x93, 0x9a, 0xe1, 0x9c, 0x43, 0xd8, 0x0a, 0x5d,
    0x93, 0xbd, 0x83, 0xb8, 0xa2, 0xfd, 0xf0, 0xc9,
    0x94, 0xcd, 0x73, 0x9f, 0x18, 0xa5, 0xd6, 0x34,
    0xab, 0xcb, 0xfe, 0x3b, 0x1c, 0x61, 0xd9, 0x72,
    0x9d, 0xda, 0x19, 0x14, 0x1d, 0x21, 0x4e, 0xf6,
    0x1c, 0xea, 0x83, 0xf7, 0x59, 0x17, 0x69, 0xa5,
    0x32, 0x53, 0xdc, 0x5a, 0x37, 0x29, 0xdd, 0xd1,
    0x0b, 0xbf, 0x65, 0x05, 0xdb, 0xbe, 0x44, 0x98,
    0x50, 0x99, 0x46, 0x1a, 0xb5, 0x91, 0xce, 0x04,
    0xda, 0x9c, 0x99, 0xbf, 0x28, 0x6a, 0x18, 0x16,
    0x61, 0x93, 0xb7, 0x57, 0x4e, 0x66, 0xc9, 0x90,
    0x68, 0x99, 0xbc, 0xe8, 0x8b, 0x24, 0xc7, 0x2e,
    0xf6, 0xf2, 0x42, 0xb5, 0x50, 0x70, 0xf4, 0x11,
    0x61, 0x55, 0x63, 0xd1, 0x6d, 0x12, 0xe7, 0xbd,
    0x71, 0xa5, 0x24, 0xb6, 0x8d, 0x2e, 0xcb, 0x19,
    0x04, 0x74, 0xe8, 0xbd, 0x4d, 0x2e, 0x91, 0xe4,
    0x2b, 0x81, 0xae, 0xf7, 0x94, 0x7e, 0x0b, 0x73,
    0x38, 0x6a, 0x26, 0xde, 0x56, 0x6d, 0xb4, 0x64,
    0x14, 0x6d, 0xc6, 0x66, 0x08, 0x06, 0xf7, 0xed,
    0xc7, 0x51, 0x08, 0x24, 0xac, 0xae, 0x42, 0x65,
    0x84, 0x26, 0x0b, 0xff, 0x95, 0x2a, 0xac, 0xd5,
    0xd9, 0x52, 0x2f, 0xdc, 0xa1, 0xa0, 0x2f, 0x95,
    0xa4, 0xed, 0xf7, 0x45, 0xd4, 0x7e, 0x92, 0x69,
    0x4b, 0x7e, 0xb7, 0x09, 0x0a, 0xec, 0x5b, 0xe0,
    0xa9, 0x94, 0xfe, 0xfc,
];

let gdm = SString::new(&general_device_manager);

assert_eq!(
    gdm.garbage(),
    vec![
        184, 156, 217, 194, 217, 244, 131, 234,
        252, 147, 154, 225, 156, 216, 147, 189,
        131, 184, 162, 253, 240, 205, 159, 165,
        214, 171, 203, 254, 217, 157, 218, 246,
        234, 131, 247, 165, 220, 221, 209, 191,
        152, 153, 181, 145, 206, 153, 191, 147,
        183, 153, 188, 232, 139, 199, 246, 242,
        181, 244, 209, 231, 189, 165, 182, 141,
        203, 232, 189, 145, 228, 129, 174, 247,
        148, 222, 180, 198, 247, 237, 199, 172,
        174, 132, 255, 149, 172, 213, 217, 160,
        149, 164, 237, 247, 212, 146, 183, 236,
        254, 252,
    ]
);

assert_eq!(&gdm.soft_word(), "x\u{14}`t$Z3ɱ11B\u{f}\u{3}BC\n]ɔs\u{18}4;\u{1c}ar\u{19}\u{14}\u{1d}!N\u{1c}Y\u{17}i2SZ7)\u{b}e\u{5}۾DPF\u{1a}\u{4}ڜ(j\u{18}\u{16}aWNfɐh$.BPp\u{11}aUcm\u{12}q$.\u{19}\u{4}tM.+~\u{b}s8j&Vmd\u{14}mf\u{8}\u{6}Q\u{8}$Be&\u{b}*R/ܡ/E~iK~\t\n[\u{a54}");

```
